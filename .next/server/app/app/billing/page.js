(()=>{var e={};e.id=352,e.ids=[352],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4954:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>o}),r(4130),r(8054),r(2029),r(5866);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),l=r(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(t,c);let o=["",{children:["app",{children:["billing",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4130)),"/Users/yadvinder.singh/Documents/New project/src/app/app/billing/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8054)),"/Users/yadvinder.singh/Documents/New project/src/app/app/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2029)),"/Users/yadvinder.singh/Documents/New project/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/yadvinder.singh/Documents/New project/src/app/app/billing/page.tsx"],u="/app/billing/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/app/billing/page",pathname:"/app/billing",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9417:(e,t,r)=>{let s={fc87171cf7b7125fb5ecf987b9400356c8451855:()=>Promise.resolve().then(r.bind(r,5736)).then(e=>e.logoutAction)};async function a(e,...t){return(await s[e]()).apply(null,t)}e.exports={fc87171cf7b7125fb5ecf987b9400356c8451855:a.bind(null,"fc87171cf7b7125fb5ecf987b9400356c8451855")}},4544:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},8656:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9404,23)),Promise.resolve().then(r.bind(r,7490))},1910:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9404,23))},8153:()=>{},434:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var s=r(9404),a=r.n(s)},5047:(e,t,r)=>{"use strict";var s=r(7389);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},7490:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var s=r(326),a=r(434),i=r(5047);let n=[{href:"/app/reviews",label:"Reviews"},{href:"/app/templates",label:"Templates"},{href:"/app/billing",label:"Billing"},{href:"/app/settings",label:"Settings"}];function l(){let e=(0,i.usePathname)();return s.jsx("nav",{className:"flex items-center gap-2 text-sm",children:n.map(t=>{let r=e===t.href||e.startsWith(`${t.href}/`);return s.jsx(a.default,{href:t.href,className:`rounded-full px-3 py-1.5 transition ${r?"bg-[#E6ECF5] text-ink":"text-slate hover:bg-[#F1F4F9] hover:text-ink"}`,children:t.label},t.href)})})}},5736:(e,t,r)=>{"use strict";r.r(t),r.d(t,{logoutAction:()=>n});var s=r(4330);r(166);var a=r(8585),i=r(5655);async function n(){let e=(0,i.f)();await e.auth.signOut(),(0,a.redirect)("/login?message=You%20have%20been%20logged%20out.")}(0,r(618).h)([n]),(0,s.j)("fc87171cf7b7125fb5ecf987b9400356c8451855",n)},4130:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(9510),a=r(7371),i=r(5456),n=r(5655),l=r(7690);async function c({searchParams:e}){let{firmId:t,user:r}=await (0,i.G)(),c=(0,n.f)(),o=await (0,l.a)(t,r.email),{data:d}=await c.from("firm_billing").select("plan_type, status, trial_remaining, credits_balance, founder_override").eq("firm_id",t).single(),u=e?.source==="onboarding";return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"section-title",children:"Billing"}),s.jsx("h1",{className:"font-serif text-3xl font-semibold",children:"Choose your plan"}),s.jsx("p",{className:"mt-2 text-sm text-slate",children:"Unlimited plans for active firms or one-file credits for occasional use."})]}),u?s.jsx("div",{className:"rounded-xl border border-[#E9DEBF] bg-[#FFFDF6] p-4 text-sm text-slate",children:"Set up billing to continue once your free trial ends."}):null,e?.success==="true"?s.jsx("div",{className:"rounded-xl border border-[#C7D9CC] bg-[#F2FAF4] p-4 text-sm text-[#1E5B2B]",children:"Billing updated successfully."}):null,e?.canceled==="true"?s.jsx("div",{className:"rounded-xl border border-[#E6D1B8] bg-[#FFF8EE] p-4 text-sm text-slate",children:"Checkout canceled. No changes were made."}):null,(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("form",{action:"/api/stripe/checkout",method:"POST",className:"card p-5 space-y-3",children:[s.jsx("input",{type:"hidden",name:"plan",value:"monthly"}),s.jsx("h2",{className:"font-serif text-xl font-semibold",children:"$50 / month"}),s.jsx("p",{className:"text-sm text-slate",children:"Unlimited status certificate reviews."}),s.jsx("button",{className:"btn btn-primary w-full",children:"Start Monthly"})]}),(0,s.jsxs)("form",{action:"/api/stripe/checkout",method:"POST",className:"card p-5 space-y-3",children:[s.jsx("input",{type:"hidden",name:"plan",value:"yearly"}),s.jsx("h2",{className:"font-serif text-xl font-semibold",children:"$500 / year"}),s.jsx("p",{className:"text-sm text-slate",children:"Unlimited reviews with annual savings."}),s.jsx("button",{className:"btn btn-primary w-full",children:"Start Yearly"})]}),(0,s.jsxs)("form",{action:"/api/stripe/checkout",method:"POST",className:"card p-5 space-y-3",children:[s.jsx("input",{type:"hidden",name:"plan",value:"credit"}),s.jsx("h2",{className:"font-serif text-xl font-semibold",children:"$10 one-file"}),s.jsx("p",{className:"text-sm text-slate",children:"One review credit for occasional files."}),s.jsx("button",{className:"btn btn-secondary w-full",children:"Buy 1 Credit"})]})]}),(0,s.jsxs)("div",{className:"card p-6 space-y-2",children:[s.jsx("h2",{className:"font-serif text-xl font-semibold",children:"Current entitlements"}),(0,s.jsxs)("p",{className:"text-sm text-slate",children:["Current entitlement: ",o.entitlementLabel]}),(0,s.jsxs)("p",{className:"text-sm text-slate",children:["Plan: ",d?.plan_type?`${d.plan_type[0].toUpperCase()}${d.plan_type.slice(1)}`:"No subscription plan"]}),(0,s.jsxs)("p",{className:"text-sm text-slate",children:["Subscription status: ",d?.status||"Not subscribed"]}),(0,s.jsxs)("p",{className:"text-sm text-slate",children:["Trial remaining: ",d?.trial_remaining??0]}),(0,s.jsxs)("p",{className:"text-sm text-slate",children:["Credits balance: ",d?.credits_balance??0]}),(0,s.jsxs)("p",{className:"text-sm text-slate",children:["Founder override: ",d?.founder_override?"Yes":"No"]}),o.nearLimitMessage?s.jsx("div",{className:"mt-2 rounded-xl border border-[#E9DEBF] bg-[#FFFDF6] p-3 text-sm text-slate",children:o.nearLimitMessage}):null]}),u&&((d?.trial_remaining??0)>0||d?.founder_override||d?.status==="active")?s.jsx("div",{children:s.jsx(a.default,{href:"/app/reviews",className:"btn btn-secondary",children:"Continue to Reviews"})}):null]})}},8054:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(9510),a=r(7371),i=r(5456);let n=(0,r(8570).createProxy)(String.raw`/Users/yadvinder.singh/Documents/New project/src/components/AppNav.tsx#default`);var l=r(5736);async function c({children:e}){return await (0,i.V)(),(0,s.jsxs)("div",{className:"min-h-screen bg-[var(--bg)]",children:[s.jsx("header",{className:"border-b border-[var(--border)] bg-white/95 backdrop-blur",children:(0,s.jsxs)("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-6 py-5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-8",children:[s.jsx(a.default,{href:"/app/reviews",className:"font-semibold tracking-wide",children:"StatusCert AI"}),s.jsx(n,{})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-xs uppercase tracking-[0.2em] text-slate",children:"Ontario Condo Review Platform"}),s.jsx("form",{action:l.logoutAction,children:s.jsx("button",{className:"btn btn-secondary px-4 py-1.5 text-xs",children:"Log out"})})]})]})}),s.jsx("main",{className:"mx-auto max-w-6xl px-6 py-10",children:e})]})}},2029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>c});var s=r(9510),a=r(2851),i=r.n(a),n=r(7337),l=r.n(n);r(5023);let c={title:"StatusCert AI",description:"Lawyer-grade status certificate reviews for Ontario real estate firms."};function o({children:e}){return s.jsx("html",{lang:"en",className:`${i().variable} ${l().variable}`,children:s.jsx("body",{className:"font-sans",children:e})})}},5456:(e,t,r)=>{"use strict";r.d(t,{G:()=>l,V:()=>n});var s=r(8585),a=r(5655),i=r(9658);async function n(){let e=(0,a.f)(),{data:t}=await e.auth.getUser();return t.user||(0,s.redirect)("/login"),t.user}async function l(){let e=(0,a.f)(),t=(0,i.h)(),{data:{user:r}}=await e.auth.getUser();r||(0,s.redirect)("/login");let{data:n,error:l}=await t.from("firm_members").select("firm_id, role").eq("user_id",r.id).maybeSingle();return l&&(0,s.redirect)(`/login?error=${encodeURIComponent(`Membership lookup failed: ${l.message}`)}`),n?.firm_id||(0,s.redirect)("/login?error=No%20firm%20membership%20found%20for%20this%20account."),{firmId:n.firm_id,role:n.role,user:r}}},7690:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var s=r(5655),a=r(1835);async function i(e,t){let r=(0,s.f)(),{data:i}=await r.from("firm_billing").select("trial_remaining, credits_balance, status, plan_type, founder_override").eq("firm_id",e).single(),n=(process.env.FOUNDER_EMAILS||"").split(",").map(e=>e.trim().toLowerCase()).filter(Boolean),l=!!i?.founder_override||!!t&&n.includes(t.toLowerCase()),c=i?.status==="active"&&(i?.plan_type==="monthly"||i?.plan_type==="yearly"),o=(0,a.pi)({founderOverride:l,activeSubscription:c,trialRemaining:i?.trial_remaining??Number(process.env.FREE_TRIAL_REVIEWS||1),creditsBalance:i?.credits_balance??0}),d="NONE",u="No active entitlement",m=null;return o.founderOverride?(d="FOUNDER",u="Founder access (unlimited)"):o.activeSubscription&&i?.plan_type==="yearly"?(d="YEARLY",u="Yearly plan (unlimited)"):o.activeSubscription&&i?.plan_type==="monthly"?(d="MONTHLY",u="Monthly plan (unlimited)"):o.creditsBalance>0?(d="CREDITS",u=`One-file credits (${o.creditsBalance} remaining)`,o.creditsBalance<=1&&(m="You are on your last one-file credit.")):o.trialRemaining>0?(d="TRIAL",u=`Free trial (${o.trialRemaining} review remaining)`,o.trialRemaining<=1&&(m="Your free trial is about to end.")):m="No trial or credits remaining.",{...o,rawPlanType:i?.plan_type||null,rawStatus:i?.status||null,entitlementType:d,entitlementLabel:u,nearLimitMessage:m}}},1835:(e,t,r)=>{"use strict";function s(e){return e.founderOverride||e.activeSubscription||e.trialRemaining>0||e.creditsBalance>0}function a(e){return e.founderOverride?{...e,allowed:!0,reason:"FOUNDER_OVERRIDE"}:e.activeSubscription?{...e,allowed:!0,reason:"ACTIVE_SUBSCRIPTION"}:e.trialRemaining>0?{...e,allowed:!0,reason:"TRIAL_AVAILABLE"}:e.creditsBalance>0?{...e,allowed:!0,reason:"CREDITS_AVAILABLE"}:{...e,allowed:!1,reason:"NO_ENTITLEMENTS"}}function i(e){return e.founderOverride||e.activeSubscription?{...e}:e.trialRemaining>0?{...e,trialRemaining:e.trialRemaining-1}:e.creditsBalance>0?{...e,creditsBalance:e.creditsBalance-1}:{...e}}r.d(t,{Uc:()=>s,pi:()=>a,t1:()=>i})},9658:(e,t,r)=>{"use strict";r.d(t,{h:()=>a});var s=r(7857);function a(){return(0,s.eI)("https://txyjzawvhknrtzwkennn.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{persistSession:!1}})}},5655:(e,t,r)=>{"use strict";r.d(t,{f:()=>i});var s=r(1615),a=r(7721);function i(){let e=(0,s.cookies)(),t=(0,s.headers)();return(0,a.createServerClient)("https://txyjzawvhknrtzwkennn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR4eWp6YXd2aGtucnR6d2tlbm5uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4NjU2NzQsImV4cCI6MjA4MDQ0MTY3NH0.MTUhireV81KmuGDl7mMXmNXYaM4llV9k4j0-_s9MPms",{cookies:{get:t=>e.get(t)?.value,set(t,r,s){e.set({name:t,value:r,...s})},remove(t,r){e.set({name:t,value:"",...r,maxAge:0})}},headers:{get:e=>t.get(e)??void 0}})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,786,702,940,783,433],()=>r(4954));module.exports=s})();